/*
 *             Copyright (c) 2016 - 2021, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Plugin as _0x1b7a25}from'ckeditor5/src/core';import{ButtonView as _0x54ae54,View as _0x1885cb,Notification as _0x566388}from'ckeditor5/src/ui';import _0x1081ae from'./exportwordcommand';import _0x8267f5 from'../theme/icons/exportword.svg';import'../theme/exportword.css';export default class c extends _0x1b7a25{static get['pluginName'](){return'ExportWord';}static get['requires'](){return['CloudServices',_0x566388];}['init'](){const _0x5a4a39=this['editor'],t=_0x5a4a39['t'],_0x170e86=_0x5a4a39['config']['get']('exportWord')||{};_0x5a4a39['commands']['add']('exportWord',new _0x1081ae(_0x5a4a39)),_0x5a4a39['ui']['componentFactory']['add']('exportWord',_0x2ad38a=>{const _0x2530c4=_0x5a4a39['commands']['get']('exportWord'),_0x1c3657=new _0x54ae54(_0x2ad38a);_0x1c3657['set']({'label':t('Export\x20to\x20Word'),'icon':_0x8267f5,'tooltip':!0x0}),_0x1c3657['bind']('isOn','isEnabled')['to'](_0x2530c4,'isBusy','isEnabled'),_0x1c3657['extendTemplate']({'attributes':{'class':[_0x1c3657['bindTemplate']['if']('isOn','ck-exportword_status-pending')]}});const _0x100b86=new _0x1885cb();return _0x100b86['setTemplate']({'tag':'span','attributes':{'class':['ck','ck-exportword__spinner-container']},'children':[{'tag':'span','attributes':{'class':['ck','ck-exportword__spinner']}}]}),_0x1c3657['children']['add'](_0x100b86),this['listenTo'](_0x1c3657,'execute',()=>{_0x5a4a39['execute']('exportWord',_0x170e86),_0x5a4a39['editing']['view']['focus']();}),_0x1c3657;});const _0x2f4248=_0x5a4a39['plugins']['get']('CloudServices');if(!0x1===_0x170e86['tokenUrl'])this['_token']=null;else{if(_0x170e86['tokenUrl'])return _0x2f4248['registerTokenUrl'](_0x170e86['tokenUrl'])['then'](_0x413cd4=>{this['_token']=_0x413cd4;});this['_token']=_0x2f4248['token'];}}}